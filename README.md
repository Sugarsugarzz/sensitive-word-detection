### 1. 版本历史	

| 修订日期   | 版本号 | 修订人 | 备注             |
| ---------- | ------ | ------ | ---------------- |
| 2020.10.20 | 1.0    | 唐     |                  |
| 2020.10.22 | 1.1    | 唐     | 补充具体实现方法 |

### 2. 参数说明

#### 请求方式

​	**POST**

#### 请求参数

| 名称    | 是否必选 | 类型   | 说明       |
| ------- | -------- | ------ | ---------- |
| content | 是       | String | 待检测文本 |

#### 响应消息

| 名称        | 类型               | 说明                                           |
| ----------- | ------------------ | ---------------------------------------------- |
| code        | Integer            | 状态码，200为调用成功，其他为异常              |
| msg         | String             | 状态消息                                       |
| data        | Object             | 调用成功时表示调用结果<br />调用失败时无此字段 |
| content     | String             | 待检测文本                                     |
| replace     | String             | 敏感词过滤后的文本                             |
| words       | List&lt;String&gt; | 检测到的敏感词列表                             |
| sensitivity | Double             | 敏感度                                         |

### 3. 具体实现方法

#### 数据库

- sensitive_words 表：敏感词库

- sensitive_words_aspects表：敏感等级表

#### 敏感词检测算法

​	使用极其高效的优化AC自动机（Aho-Corasick Automation）算法，时间复杂度为O(n)。

​	对文本一遍遍历即可检测出所有涉及的敏感词。

#### 敏感度计算方式

​	维护一个敏感等级表（sensitive_words_aspects），存储敏感等级名以及对应的敏感度初始值。

​	对敏感词库进行标注，将每个敏感词与敏感等级进行对应。

​	取检测到的敏感词触发的最高敏感等级的初始敏感度值，与敏感词在有效文本中的占比进行叠加，按照 85 ：15的比例。得到最终的文本敏感度值。

### 4. 调用示例

- 请求示例

  ```http
  POST http://localhost:8080/sensitive
      
  Content-Type:application/json
  Request Body:
  {
     "content": "打击台独分子，打击国民党；拥护毛泽东；台弯；中国共产党；习近平；xjp;藏独；脏读；新疆暴乱’64六四；台wan叶剑英taiwan'发轮功"
  }
  ```

- 成功响应示例

  ```json
  {
      "code": 200,
      "msg": "操作成功!",
      "data": {
          "content": "打击台独分子，打击国民党；拥护毛泽东；台弯；中国共产党；习近平；xjp;藏独；脏读；新疆暴乱’64六四；台wan叶剑英taiwan'发轮功",
          "replace": "打击**分子，打击***；拥护***；**；中国***；***；***;**；脏读；****’64**；*************'***",
          "words": [
              "台独",
              "国民党",
              "毛泽东",
              "台弯",
              "共产党",
              "习近平",
              "xjp",
              "藏独",
              "新疆暴乱",
              "六四",
              "台wan",
              "叶剑英",
              "taiwan",
              "发轮",
              "发轮功",
              "轮功"
          ],
          "sensitivity": 96.32
      }
  }
  ```

- 失败响应示例

  ```json
  {
      "code": 400,
      "msg": "操作失败!"
  }
  ```
